{"version":3,"file":"quikdown.umd.min.js","sources":["../src/quikdown.js"],"sourcesContent":["/**\n * quikdown - A minimal markdown parser optimized for chat/LLM output\n * Supports tables, code blocks, lists, and common formatting\n * @param {string} markdown - The markdown source text\n * @param {Object} options - Optional configuration object\n * @param {Function} options.fence_plugin - Custom renderer for fenced code blocks\n *                   (content, fence_string) => html string\n * @param {boolean} options.inline_styles - If true, uses inline styles instead of classes\n * @param {boolean} options.bidirectional - If true, adds data-qd attributes for source tracking\n * @param {boolean} options.lazy_linefeeds - If true, single newlines become <br> tags\n * @returns {string} - The rendered HTML\n */\n\n// Version will be injected at build time  \nconst quikdownVersion = '__QUIKDOWN_VERSION__';\n\n// Constants for reuse\nconst CLASS_PREFIX = 'quikdown-';\nconst PLACEHOLDER_CB = '§CB';\nconst PLACEHOLDER_IC = '§IC';\n\n// Escape map at module level\nconst ESC_MAP = {'&':'&amp;','<':'&lt;','>':'&gt;','\"':'&quot;',\"'\":'&#39;'};\n\n// Single source of truth for all style definitions - optimized\nconst QUIKDOWN_STYLES = {\n    h1: 'font-size:2em;font-weight:600;margin:.67em 0;text-align:left',\n    h2: 'font-size:1.5em;font-weight:600;margin:.83em 0',\n    h3: 'font-size:1.25em;font-weight:600;margin:1em 0',\n    h4: 'font-size:1em;font-weight:600;margin:1.33em 0',\n    h5: 'font-size:.875em;font-weight:600;margin:1.67em 0',\n    h6: 'font-size:.85em;font-weight:600;margin:2em 0',\n    pre: 'background:#f4f4f4;padding:10px;border-radius:4px;overflow-x:auto;margin:1em 0',\n    code: 'background:#f0f0f0;padding:2px 4px;border-radius:3px;font-family:monospace',\n    blockquote: 'border-left:4px solid #ddd;margin-left:0;padding-left:1em',\n    table: 'border-collapse:collapse;width:100%;margin:1em 0',\n    th: 'border:1px solid #ddd;padding:8px;background-color:#f2f2f2;font-weight:bold;text-align:left',\n    td: 'border:1px solid #ddd;padding:8px;text-align:left',\n    hr: 'border:none;border-top:1px solid #ddd;margin:1em 0',\n    img: 'max-width:100%;height:auto',\n    a: 'color:#06c;text-decoration:underline',\n    strong: 'font-weight:bold',\n    em: 'font-style:italic',\n    del: 'text-decoration:line-through',\n    ul: 'margin:.5em 0;padding-left:2em',\n    ol: 'margin:.5em 0;padding-left:2em',\n    li: 'margin:.25em 0',\n    // Task list specific styles\n    'task-item': 'list-style:none',\n    'task-checkbox': 'margin-right:.5em'\n};\n\n// Factory function to create getAttr for a given context\nfunction createGetAttr(inline_styles, styles) {\n    return function(tag, additionalStyle = '') {\n        if (inline_styles) {\n            const style = styles[tag];\n            if (!style && !additionalStyle) return '';\n            /* istanbul ignore next - defensive: additionalStyle without style doesn't occur with current tags */\n            const fullStyle = additionalStyle ? (style ? `${style};${additionalStyle}` : additionalStyle) : style;\n            return ` style=\"${fullStyle}\"`;\n        } else {\n            return ` class=\"${CLASS_PREFIX}${tag}\"`;\n        }\n    };\n}\n\nfunction quikdown(markdown, options = {}) {\n    if (!markdown || typeof markdown !== 'string') {\n        return '';\n    }\n    \n    const { fence_plugin, inline_styles = false, bidirectional = false, lazy_linefeeds = false } = options;\n    const styles = QUIKDOWN_STYLES; // Use module-level styles\n    const getAttr = createGetAttr(inline_styles, styles); // Create getAttr once\n\n    // Escape HTML entities to prevent XSS\n    function escapeHtml(text) {\n        return text.replace(/[&<>\"']/g, m => ESC_MAP[m]);\n    }\n    \n    // Helper to add data-qd attributes for bidirectional support\n    const dataQd = bidirectional ? (marker) => ` data-qd=\"${escapeHtml(marker)}\"` : () => '';\n    \n    // Sanitize URLs to prevent XSS attacks\n    function sanitizeUrl(url, allowUnsafe = false) {\n        /* istanbul ignore next - defensive programming, regex ensures url is never empty */\n        if (!url) return '';\n        \n        // If unsafe URLs are explicitly allowed, return as-is\n        if (allowUnsafe) return url;\n        \n        const trimmedUrl = url.trim();\n        const lowerUrl = trimmedUrl.toLowerCase();\n        \n        // Block dangerous protocols\n        const dangerousProtocols = ['javascript:', 'vbscript:', 'data:'];\n        \n        for (const protocol of dangerousProtocols) {\n            if (lowerUrl.startsWith(protocol)) {\n                // Exception: Allow data:image/* for images\n                if (protocol === 'data:' && lowerUrl.startsWith('data:image/')) {\n                    return trimmedUrl;\n                }\n                // Return safe empty link for dangerous protocols\n                return '#';\n            }\n        }\n        \n        return trimmedUrl;\n    }\n\n    // Process the markdown in phases\n    let html = markdown;\n    \n    // Phase 1: Extract and protect code blocks and inline code\n    const codeBlocks = [];\n    const inlineCodes = [];\n    \n    // Extract fenced code blocks first (supports both ``` and ~~~)\n    // Match paired fences - ``` with ``` and ~~~ with ~~~\n    // Fence must be at start of line\n    html = html.replace(/^(```|~~~)([^\\n]*)\\n([\\s\\S]*?)^\\1$/gm, (match, fence, lang, code) => {\n        const placeholder = `${PLACEHOLDER_CB}${codeBlocks.length}§`;\n        \n        // Trim the language specification\n        const langTrimmed = lang ? lang.trim() : '';\n        \n        // If custom fence plugin is provided, use it\n        if (fence_plugin && typeof fence_plugin === 'function') {\n            codeBlocks.push({\n                lang: langTrimmed,\n                code: code.trimEnd(),\n                custom: true,\n                fence: fence\n            });\n        } else {\n            codeBlocks.push({\n                lang: langTrimmed,\n                code: escapeHtml(code.trimEnd()),\n                custom: false,\n                fence: fence\n            });\n        }\n        return placeholder;\n    });\n    \n    // Extract inline code\n    html = html.replace(/`([^`]+)`/g, (match, code) => {\n        const placeholder = `${PLACEHOLDER_IC}${inlineCodes.length}§`;\n        inlineCodes.push(escapeHtml(code));\n        return placeholder;\n    });\n    \n    // Now escape HTML in the rest of the content\n    html = escapeHtml(html);\n    \n    // Phase 2: Process block elements\n    \n    // Process tables\n    html = processTable(html, getAttr);\n    \n    // Process headings (supports optional trailing #'s)\n    html = html.replace(/^(#{1,6})\\s+(.+?)\\s*#*$/gm, (match, hashes, content) => {\n        const level = hashes.length;\n        return `<h${level}${getAttr('h' + level)}${dataQd(hashes)}>${content}</h${level}>`;\n    });\n    \n    // Process blockquotes (must handle escaped > since we already escaped HTML)\n    html = html.replace(/^&gt;\\s+(.+)$/gm, `<blockquote${getAttr('blockquote')}>$1</blockquote>`);\n    // Merge consecutive blockquotes\n    html = html.replace(/<\\/blockquote>\\n<blockquote>/g, '\\n');\n    \n    // Process horizontal rules\n    html = html.replace(/^---+$/gm, `<hr${getAttr('hr')}>`);\n    \n    // Process lists\n    html = processLists(html, getAttr, inline_styles, bidirectional);\n    \n    // Phase 3: Process inline elements\n    \n    // Images (must come before links, with URL sanitization)\n    html = html.replace(/!\\[([^\\]]*)\\]\\(([^)]+)\\)/g, (match, alt, src) => {\n        const sanitizedSrc = sanitizeUrl(src, options.allow_unsafe_urls);\n        const altAttr = bidirectional && alt ? ` data-qd-alt=\"${escapeHtml(alt)}\"` : '';\n        const srcAttr = bidirectional ? ` data-qd-src=\"${escapeHtml(src)}\"` : '';\n        return `<img${getAttr('img')} src=\"${sanitizedSrc}\" alt=\"${alt}\"${altAttr}${srcAttr}${dataQd('!')}>`;\n    });\n    \n    // Links (with URL sanitization)\n    html = html.replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/g, (match, text, href) => {\n        // Sanitize URL to prevent XSS\n        const sanitizedHref = sanitizeUrl(href, options.allow_unsafe_urls);\n        const isExternal = /^https?:\\/\\//i.test(sanitizedHref);\n        const rel = isExternal ? ' rel=\"noopener noreferrer\"' : '';\n        const textAttr = bidirectional ? ` data-qd-text=\"${escapeHtml(text)}\"` : '';\n        return `<a${getAttr('a')} href=\"${sanitizedHref}\"${rel}${textAttr}${dataQd('[')}>${text}</a>`;\n    });\n    \n    // Autolinks - convert bare URLs to clickable links\n    html = html.replace(/(^|\\s)(https?:\\/\\/[^\\s<]+)/g, (match, prefix, url) => {\n        const sanitizedUrl = sanitizeUrl(url, options.allow_unsafe_urls);\n        return `${prefix}<a${getAttr('a')} href=\"${sanitizedUrl}\" rel=\"noopener noreferrer\">${url}</a>`;\n    });\n    \n    // Process inline formatting (bold, italic, strikethrough)\n    const inlinePatterns = [\n        [/\\*\\*(.+?)\\*\\*/g, 'strong', '**'],\n        [/__(.+?)__/g, 'strong', '__'],\n        [/(?<!\\*)\\*(?!\\*)(.+?)(?<!\\*)\\*(?!\\*)/g, 'em', '*'],\n        [/(?<!_)_(?!_)(.+?)(?<!_)_(?!_)/g, 'em', '_'],\n        [/~~(.+?)~~/g, 'del', '~~']\n    ];\n    \n    inlinePatterns.forEach(([pattern, tag, marker]) => {\n        html = html.replace(pattern, `<${tag}${getAttr(tag)}${dataQd(marker)}>$1</${tag}>`);\n    });\n    \n    // Line breaks\n    if (lazy_linefeeds) {\n        // Lazy linefeeds: single newline becomes <br> (except between paragraphs and after/before block elements)\n        \n        // First, protect complete block structures (tables and lists with their internal newlines)\n        const protectedBlocks = [];\n        let blockIndex = 0;\n        \n        // Protect complete table structures\n        html = html.replace(/<table[^>]*>[\\s\\S]*?<\\/table>/g, (match) => {\n            const placeholder = `§PROTECTED_BLOCK_${blockIndex}§`;\n            protectedBlocks[blockIndex] = match;\n            blockIndex++;\n            return placeholder;\n        });\n        \n        // Protect complete list structures\n        html = html.replace(/<[uo]l[^>]*>[\\s\\S]*?<\\/[uo]l>/g, (match) => {\n            const placeholder = `§PROTECTED_BLOCK_${blockIndex}§`;\n            protectedBlocks[blockIndex] = match;\n            blockIndex++;\n            return placeholder;\n        });\n        \n        // Handle double newlines for paragraphs\n        html = html.replace(/\\n\\n+/g, '§PARAGRAPH§');\n        \n        // Don't add <br> after block elements\n        html = html.replace(/(<\\/(?:h[1-6]|blockquote|pre)>)\\n/g, '$1§BLOCKBREAK§');\n        html = html.replace(/(<(?:h[1-6]|blockquote|pre)[^>]*>)\\n/g, '$1§BLOCKBREAK§');\n        html = html.replace(/(<hr[^>]*>)\\n/g, '$1§BLOCKBREAK§');\n        \n        // Don't add <br> before block elements\n        html = html.replace(/\\n(<(?:h[1-6]|blockquote|pre|hr)[^>]*>)/g, '§BLOCKBREAK§$1');\n        html = html.replace(/\\n(§PROTECTED_BLOCK_\\d+§)/g, '§BLOCKBREAK§$1');\n        html = html.replace(/(§PROTECTED_BLOCK_\\d+§)\\n/g, '$1§BLOCKBREAK§');\n        \n        // Convert remaining single newlines to <br>\n        html = html.replace(/\\n/g, `<br${getAttr('br')}>`);\n        \n        // Restore block breaks as simple newlines\n        html = html.replace(/§BLOCKBREAK§/g, '\\n');\n        \n        // Restore paragraph breaks\n        html = html.replace(/§PARAGRAPH§/g, '</p><p>');\n        \n        // Restore protected blocks\n        protectedBlocks.forEach((block, i) => {\n            html = html.replace(`§PROTECTED_BLOCK_${i}§`, block);\n        });\n        \n        // Wrap in paragraph tags\n        html = '<p>' + html + '</p>';\n    } else {\n        // Standard: two spaces at end of line for line breaks\n        html = html.replace(/  $/gm, `<br${getAttr('br')}>`);\n        \n        // Paragraphs (double newlines)\n        html = html.replace(/\\n\\n+/g, '</p><p>');\n        html = '<p>' + html + '</p>';\n    }\n    \n    // Clean up empty paragraphs and unwrap block elements\n    const cleanupPatterns = [\n        [/<p><\\/p>/g, ''],\n        [/<p>(<h[1-6][^>]*>)/g, '$1'],\n        [/(<\\/h[1-6]>)<\\/p>/g, '$1'],\n        [/<p>(<blockquote[^>]*>)/g, '$1'],\n        [/(<\\/blockquote>)<\\/p>/g, '$1'],\n        [/<p>(<ul[^>]*>|<ol[^>]*>)/g, '$1'],\n        [/(<\\/ul>|<\\/ol>)<\\/p>/g, '$1'],\n        [/<p>(<hr[^>]*>)<\\/p>/g, '$1'],\n        [/<p>(<table[^>]*>)/g, '$1'],\n        [/(<\\/table>)<\\/p>/g, '$1'],\n        [/<p>(<pre[^>]*>)/g, '$1'],\n        [/(<\\/pre>)<\\/p>/g, '$1'],\n        [new RegExp(`<p>(${PLACEHOLDER_CB}\\\\d+§)<\\/p>`, 'g'), '$1']\n    ];\n    \n    cleanupPatterns.forEach(([pattern, replacement]) => {\n        html = html.replace(pattern, replacement);\n    });\n    \n    // Phase 4: Restore code blocks and inline code\n    \n    // Restore code blocks\n    codeBlocks.forEach((block, i) => {\n        let replacement;\n        \n        if (block.custom && fence_plugin) {\n            // Use custom fence plugin\n            replacement = fence_plugin(block.code, block.lang);\n            // If plugin returns undefined, fall back to default rendering\n            if (replacement === undefined) {\n                const langClass = !inline_styles && block.lang ? ` class=\"language-${block.lang}\"` : '';\n                const codeAttr = inline_styles ? getAttr('code') : langClass;\n                const langAttr = bidirectional && block.lang ? ` data-qd-lang=\"${escapeHtml(block.lang)}\"` : '';\n                const fenceAttr = bidirectional ? ` data-qd-fence=\"${escapeHtml(block.fence)}\"` : '';\n                replacement = `<pre${getAttr('pre')}${fenceAttr}${langAttr}><code${codeAttr}>${escapeHtml(block.code)}</code></pre>`;\n            }\n        } else {\n            // Default rendering\n            const langClass = !inline_styles && block.lang ? ` class=\"language-${block.lang}\"` : '';\n            const codeAttr = inline_styles ? getAttr('code') : langClass;\n            const langAttr = bidirectional && block.lang ? ` data-qd-lang=\"${escapeHtml(block.lang)}\"` : '';\n            const fenceAttr = bidirectional ? ` data-qd-fence=\"${escapeHtml(block.fence)}\"` : '';\n            replacement = `<pre${getAttr('pre')}${fenceAttr}${langAttr}><code${codeAttr}>${block.code}</code></pre>`;\n        }\n        \n        const placeholder = `${PLACEHOLDER_CB}${i}§`;\n        html = html.replace(placeholder, replacement);\n    });\n    \n    // Restore inline code\n    inlineCodes.forEach((code, i) => {\n        const placeholder = `${PLACEHOLDER_IC}${i}§`;\n        html = html.replace(placeholder, `<code${getAttr('code')}${dataQd('`')}>${code}</code>`);\n    });\n    \n    return html.trim();\n}\n\n/**\n * Process inline markdown formatting\n */\nfunction processInlineMarkdown(text, getAttr) {\n    \n    // Process inline formatting patterns\n    const patterns = [\n        [/\\*\\*(.+?)\\*\\*/g, 'strong'],\n        [/__(.+?)__/g, 'strong'],\n        [/(?<!\\*)\\*(?!\\*)(.+?)(?<!\\*)\\*(?!\\*)/g, 'em'],\n        [/(?<!_)_(?!_)(.+?)(?<!_)_(?!_)/g, 'em'],\n        [/~~(.+?)~~/g, 'del'],\n        [/`([^`]+)`/g, 'code']\n    ];\n    \n    patterns.forEach(([pattern, tag]) => {\n        text = text.replace(pattern, `<${tag}${getAttr(tag)}>$1</${tag}>`);\n    });\n    \n    return text;\n}\n\n/**\n * Process markdown tables\n */\nfunction processTable(text, getAttr) {\n    const lines = text.split('\\n');\n    const result = [];\n    let inTable = false;\n    let tableLines = [];\n    \n    for (let i = 0; i < lines.length; i++) {\n        const line = lines[i].trim();\n        \n        // Check if this line looks like a table row (with or without trailing |)\n        if (line.includes('|') && (line.startsWith('|') || /[^\\\\|]/.test(line))) {\n            if (!inTable) {\n                inTable = true;\n                tableLines = [];\n            }\n            tableLines.push(line);\n        } else {\n            // Not a table line\n            if (inTable) {\n                // Process the accumulated table\n                const tableHtml = buildTable(tableLines, getAttr);\n                if (tableHtml) {\n                    result.push(tableHtml);\n                } else {\n                    // Not a valid table, restore original lines\n                    result.push(...tableLines);\n                }\n                inTable = false;\n                tableLines = [];\n            }\n            result.push(lines[i]);\n        }\n    }\n    \n    // Handle table at end of text\n    if (inTable && tableLines.length > 0) {\n        const tableHtml = buildTable(tableLines, getAttr);\n        if (tableHtml) {\n            result.push(tableHtml);\n        } else {\n            result.push(...tableLines);\n        }\n    }\n    \n    return result.join('\\n');\n}\n\n/**\n * Build an HTML table from markdown table lines\n */\nfunction buildTable(lines, getAttr) {\n    \n    if (lines.length < 2) return null;\n    \n    // Check for separator line (second line should be the separator)\n    let separatorIndex = -1;\n    for (let i = 1; i < lines.length; i++) {\n        // Support separator with or without leading/trailing pipes\n        if (/^\\|?[\\s\\-:|]+\\|?$/.test(lines[i]) && lines[i].includes('-')) {\n            separatorIndex = i;\n            break;\n        }\n    }\n    \n    if (separatorIndex === -1) return null;\n    \n    const headerLines = lines.slice(0, separatorIndex);\n    const bodyLines = lines.slice(separatorIndex + 1);\n    \n    // Parse alignment from separator\n    const separator = lines[separatorIndex];\n    // Handle pipes at start/end or not\n    const separatorCells = separator.trim().replace(/^\\|/, '').replace(/\\|$/, '').split('|');\n    const alignments = separatorCells.map(cell => {\n        const trimmed = cell.trim();\n        if (trimmed.startsWith(':') && trimmed.endsWith(':')) return 'center';\n        if (trimmed.endsWith(':')) return 'right';\n        return 'left';\n    });\n    \n    let html = `<table${getAttr('table')}>\\n`;\n    \n    // Build header\n    // Note: headerLines will always have length > 0 since separatorIndex starts from 1\n    html += `<thead${getAttr('thead')}>\\n`;\n    headerLines.forEach(line => {\n            html += `<tr${getAttr('tr')}>\\n`;\n            // Handle pipes at start/end or not\n            const cells = line.trim().replace(/^\\|/, '').replace(/\\|$/, '').split('|');\n            cells.forEach((cell, i) => {\n                const alignStyle = alignments[i] && alignments[i] !== 'left' ? `text-align:${alignments[i]}` : '';\n                const processedCell = processInlineMarkdown(cell.trim(), getAttr);\n                html += `<th${getAttr('th', alignStyle)}>${processedCell}</th>\\n`;\n            });\n            html += '</tr>\\n';\n    });\n    html += '</thead>\\n';\n    \n    // Build body\n    if (bodyLines.length > 0) {\n        html += `<tbody${getAttr('tbody')}>\\n`;\n        bodyLines.forEach(line => {\n            html += `<tr${getAttr('tr')}>\\n`;\n            // Handle pipes at start/end or not\n            const cells = line.trim().replace(/^\\|/, '').replace(/\\|$/, '').split('|');\n            cells.forEach((cell, i) => {\n                const alignStyle = alignments[i] && alignments[i] !== 'left' ? `text-align:${alignments[i]}` : '';\n                const processedCell = processInlineMarkdown(cell.trim(), getAttr);\n                html += `<td${getAttr('td', alignStyle)}>${processedCell}</td>\\n`;\n            });\n            html += '</tr>\\n';\n        });\n        html += '</tbody>\\n';\n    }\n    \n    html += '</table>';\n    return html;\n}\n\n/**\n * Process markdown lists (ordered and unordered)\n */\nfunction processLists(text, getAttr, inline_styles, bidirectional) {\n    \n    const lines = text.split('\\n');\n    const result = [];\n    let listStack = []; // Track nested lists\n    \n    // Helper to escape HTML for data-qd attributes\n    const escapeHtml = (text) => text.replace(/[&<>\"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','\"':'&quot;',\"'\":'&#39;'})[m]);\n    const dataQd = bidirectional ? (marker) => ` data-qd=\"${escapeHtml(marker)}\"` : () => '';\n    \n    for (let i = 0; i < lines.length; i++) {\n        const line = lines[i];\n        const match = line.match(/^(\\s*)([*\\-+]|\\d+\\.)\\s+(.+)$/);\n        \n        if (match) {\n            const [, indent, marker, content] = match;\n            const level = Math.floor(indent.length / 2);\n            const isOrdered = /^\\d+\\./.test(marker);\n            const listType = isOrdered ? 'ol' : 'ul';\n            \n            // Check for task list items\n            let listItemContent = content;\n            let taskListClass = '';\n            const taskMatch = content.match(/^\\[([x ])\\]\\s+(.*)$/i);\n            if (taskMatch && !isOrdered) {\n                const [, checked, taskContent] = taskMatch;\n                const isChecked = checked.toLowerCase() === 'x';\n                const checkboxAttr = inline_styles \n                    ? ' style=\"margin-right:.5em\"' \n                    : ` class=\"${CLASS_PREFIX}task-checkbox\"`;\n                listItemContent = `<input type=\"checkbox\"${checkboxAttr}${isChecked ? ' checked' : ''} disabled> ${taskContent}`;\n                taskListClass = inline_styles ? ' style=\"list-style:none\"' : ` class=\"${CLASS_PREFIX}task-item\"`;\n            }\n            \n            // Close deeper levels\n            while (listStack.length > level + 1) {\n                const list = listStack.pop();\n                result.push(`</${list.type}>`);\n            }\n            \n            // Open new level if needed\n            if (listStack.length === level) {\n                // Need to open a new list\n                listStack.push({ type: listType, level });\n                result.push(`<${listType}${getAttr(listType)}>`);\n            } else if (listStack.length === level + 1) {\n                // Check if we need to switch list type\n                const currentList = listStack[listStack.length - 1];\n                if (currentList.type !== listType) {\n                    result.push(`</${currentList.type}>`);\n                    listStack.pop();\n                    listStack.push({ type: listType, level });\n                    result.push(`<${listType}${getAttr(listType)}>`);\n                }\n            }\n            \n            const liAttr = taskListClass || getAttr('li');\n            result.push(`<li${liAttr}${dataQd(marker)}>${listItemContent}</li>`);\n        } else {\n            // Not a list item, close all lists\n            while (listStack.length > 0) {\n                const list = listStack.pop();\n                result.push(`</${list.type}>`);\n            }\n            result.push(line);\n        }\n    }\n    \n    // Close any remaining lists\n    while (listStack.length > 0) {\n        const list = listStack.pop();\n        result.push(`</${list.type}>`);\n    }\n    \n    return result.join('\\n');\n}\n\n/**\n * Emit CSS styles for quikdown elements\n * @param {string} prefix - Optional class prefix (default: 'quikdown-')\n * @param {string} theme - Optional theme: 'light' (default) or 'dark'\n * @returns {string} CSS string with quikdown styles\n */\nquikdown.emitStyles = function(prefix = 'quikdown-', theme = 'light') {\n    const styles = QUIKDOWN_STYLES;\n    \n    // Define theme color overrides\n    const themeOverrides = {\n        dark: {\n            '#f4f4f4': '#2a2a2a', // pre background\n            '#f0f0f0': '#2a2a2a', // code background\n            '#f2f2f2': '#2a2a2a', // th background\n            '#ddd': '#3a3a3a',    // borders\n            '#06c': '#6db3f2',    // links\n            _textColor: '#e0e0e0'\n        },\n        light: {\n            _textColor: '#333'    // Explicit text color for light theme\n        }\n    };\n    \n    let css = '';\n    for (const [tag, style] of Object.entries(styles)) {\n        let themedStyle = style;\n            \n            // Apply theme overrides if dark theme\n            if (theme === 'dark' && themeOverrides.dark) {\n                // Replace colors\n                for (const [oldColor, newColor] of Object.entries(themeOverrides.dark)) {\n                    if (!oldColor.startsWith('_')) {\n                        themedStyle = themedStyle.replace(new RegExp(oldColor, 'g'), newColor);\n                    }\n                }\n                \n                // Add text color for certain elements in dark theme\n                const needsTextColor = ['h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'td', 'li', 'blockquote'];\n                if (needsTextColor.includes(tag)) {\n                    themedStyle += `;color:${themeOverrides.dark._textColor}`;\n                }\n            } else if (theme === 'light' && themeOverrides.light) {\n                // Add explicit text color for light theme elements too\n                const needsTextColor = ['h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'td', 'li', 'blockquote'];\n                if (needsTextColor.includes(tag)) {\n                    themedStyle += `;color:${themeOverrides.light._textColor}`;\n                }\n            }\n        \n        css += `.${prefix}${tag} { ${themedStyle} }\\n`;\n    }\n    \n    return css;\n};\n\n/**\n * Configure quikdown with options and return a function\n * @param {Object} options - Configuration options\n * @returns {Function} Configured quikdown function\n */\nquikdown.configure = function(options) {\n    return function(markdown) {\n        return quikdown(markdown, options);\n    };\n};\n\n/**\n * Version information\n */\nquikdown.version = quikdownVersion;\n\n// Export for both CommonJS and ES6\n/* istanbul ignore next */\nif (typeof module !== 'undefined' && module.exports) {\n    module.exports = quikdown;\n}\n\n// For browser global\n/* istanbul ignore next */\nif (typeof window !== 'undefined') {\n    window.quikdown = quikdown;\n}\n\nexport default quikdown;"],"names":["CLASS_PREFIX","PLACEHOLDER_CB","ESC_MAP","QUIKDOWN_STYLES","h1","h2","h3","h4","h5","h6","pre","code","blockquote","table","th","td","hr","img","a","strong","em","del","ul","ol","li","quikdown","markdown","options","fence_plugin","inline_styles","bidirectional","lazy_linefeeds","getAttr","styles","tag","additionalStyle","style","createGetAttr","escapeHtml","text","replace","m","dataQd","marker","sanitizeUrl","url","allowUnsafe","trimmedUrl","trim","lowerUrl","toLowerCase","dangerousProtocols","protocol","startsWith","html","codeBlocks","inlineCodes","match","fence","lang","placeholder","length","langTrimmed","push","trimEnd","custom","lines","split","result","inTable","tableLines","i","line","includes","test","tableHtml","buildTable","join","processTable","hashes","content","level","listStack","indent","Math","floor","isOrdered","listType","listItemContent","taskListClass","taskMatch","checked","taskContent","isChecked","list","pop","type","currentList","liAttr","processLists","alt","src","sanitizedSrc","allow_unsafe_urls","altAttr","srcAttr","href","sanitizedHref","rel","textAttr","prefix","sanitizedUrl","forEach","pattern","protectedBlocks","blockIndex","block","RegExp","replacement","undefined","langClass","codeAttr","langAttr","fenceAttr","processInlineMarkdown","separatorIndex","headerLines","slice","bodyLines","alignments","map","cell","trimmed","endsWith","alignStyle","processedCell","emitStyles","theme","themeOverrides","_textColor","css","Object","entries","themedStyle","oldColor","newColor","configure","version","module","exports","window"],"mappings":"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"}