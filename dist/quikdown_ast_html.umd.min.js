/**
 * quikdown_ast_html - AST to HTML Markdown Parser
 * @version 1.1.1
 * @license BSD-2-Clause
 * @copyright DeftIO 2025
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).quikdown_ast_html=t()}(this,function(){"use strict";function e(e,n={}){if(!e||"string"!=typeof e)return{type:"document",children:[]};return{type:"document",children:t(e.replace(/\r\n/g,"\n").replace(/\r/g,"\n"))}}function t(e,i){const l=[],c=e.split("\n");let o=0;for(;o<c.length;){const e=c[o];if(""===e.trim()){o++;continue}const i=e.match(/^(```|~~~)(.*)$/);if(i){const[,e,t]=i,n=t.trim(),r=[];for(o++;o<c.length;){if(c[o].match(/^(```|~~~)\s*$/)){o++;break}r.push(c[o]),o++}l.push({type:"code_block",lang:n||null,content:r.join("\n"),fence:e});continue}if(/^---+\s*$/.test(e)||/^\*\*\*+\s*$/.test(e)||/^___+\s*$/.test(e)){l.push({type:"hr"}),o++;continue}const a=e.match(/^(#{1,6})\s*(.+?)\s*#*$/);if(a){const[,e,t]=a;l.push({type:"heading",level:e.length,children:s(t)}),o++;continue}if(e.includes("|")){const e=n(c,o);if(e){l.push(e.node),o=e.nextIndex;continue}}if(e.match(/^>\s*/)){const e=[];for(;o<c.length&&c[o].match(/^>\s*/);)e.push(c[o].replace(/^>\s*/,"")),o++;l.push({type:"blockquote",children:t(e.join("\n"))});continue}if(e.match(/^(\s*)([*\-+]|\d+\.)\s+(.*)$/)){const e=r(c,o);l.push(e.node),o=e.nextIndex;continue}const u=[];for(;o<c.length;){const e=c[o];if(""===e.trim())break;if(/^(```|~~~)/.test(e))break;if(/^#{1,6}\s/.test(e))break;if(/^---+\s*$/.test(e)||/^\*\*\*+\s*$/.test(e)||/^___+\s*$/.test(e))break;if(/^>\s*/.test(e))break;if(/^(\s*)([*\-+]|\d+\.)\s+/.test(e))break;if(e.includes("|")&&o+1<c.length&&/^\|?[\s\-:|]+\|?$/.test(c[o+1]))break;u.push(e),o++}u.length>0&&l.push({type:"paragraph",children:s(u.join("\n"))})}return l}function n(e,t,n){if(t+1>=e.length)return null;const r=e[t],l=e[t+1];if(!/^\|?[\s\-:|]+\|?$/.test(l)||!l.includes("-"))return null;const c=i(r);if(0===c.length)return null;const o=i(l).map(e=>{const t=e.trim();return t.startsWith(":")&&t.endsWith(":")?"center":t.endsWith(":")?"right":"left"}),a=c.map(e=>s(e.trim())),u=[];let d=t+2;for(;d<e.length;){const t=e[d];if(!t.includes("|")||""===t.trim())break;const n=i(t);u.push(n.map(e=>s(e.trim()))),d++}return{node:{type:"table",headers:a,rows:u,alignments:o},nextIndex:d}}function i(e){let t=e.trim();return t.startsWith("|")&&(t=t.slice(1)),t.endsWith("|")&&(t=t.slice(0,-1)),t.split("|")}function r(e,t,n){const i=[];let l=t,c=0;const o=e[l].match(/^(\s*)([*\-+]|\d+\.)\s+(.*)$/),a=/^\d+\./.test(o[2]),u=o[1].length;for(;l<e.length&&c<1e3;){c++;const t=e[l].match(/^(\s*)([*\-+]|\d+\.)\s+(.*)$/);if(!t)break;const[,n,o,d]=t,h=n.length;if(h<u)break;const f=/^\d+\./.test(o);if(h===u&&f!==a)break;if(h>u){const t=[];let n=0;for(;l<e.length&&n<1e3;){n++;const i=e[l],r=i.match(/^(\s*)([*\-+]|\d+\.)\s+/);if(!r)break;if(r[1].length<u)break;if(r[1].length===u)break;t.push(i),l++}if(t.length>0&&i.length>0){const e=r(t,0),n=i[i.length-1];n.children?Array.isArray(n.children)||(n.children=[{type:"paragraph",children:n.children}]):n.children=[],n.children.push(e.node)}continue}const p={type:"list_item",checked:null,children:null},m=d.match(/^\[([x ])\]\s*(.*)$/i);m&&!a?(p.checked="x"===m[1].toLowerCase(),p.children=s(m[2])):p.children=s(d),i.push(p),l++}return{node:{type:"list",ordered:a,items:i},nextIndex:l}}function s(e,t){if(!e)return[];const n=[];let i=e;for(;i.length>0;){let e=!1;if(i.match(/^(.+?)(?:  |\\\n|\n)/)&&i.includes("\n")){const t=i.indexOf("\n"),r=i.slice(0,t),s=i.slice(t+1);if(r.endsWith("  ")||r.endsWith("\\")){const t=r.replace(/\\$/,"").replace(/  +$/,"");t&&n.push(...l(t)),n.push({type:"br"}),i=s,e=!0;continue}}const t=i.match(/^!\[([^\]]*)\]\(\s*([^)\s]+)\s*\)/);if(t){n.push({type:"image",alt:t[1],url:t[2].trim()}),i=i.slice(t[0].length),e=!0;continue}const r=i.match(/^\[([^\]]+)\]\(\s*([^)\s]+)\s*\)/);if(r){n.push({type:"link",url:r[2].trim(),children:l(r[1])}),i=i.slice(r[0].length),e=!0;continue}const s=i.match(/^`([^`]+)`/);if(s){n.push({type:"code",value:s[1]}),i=i.slice(s[0].length),e=!0;continue}const c=i.match(/^(\*\*|__)(.+?)\1/);if(c){n.push({type:"strong",children:l(c[2])}),i=i.slice(c[0].length),e=!0;continue}const o=i.match(/^~~(.+?)~~/);if(o){n.push({type:"del",children:l(o[1])}),i=i.slice(o[0].length),e=!0;continue}const a=i.match(/^(\*|_)(?!\1)(.+?)(?<!\1)\1(?!\1)/);if(a){n.push({type:"em",children:l(a[2])}),i=i.slice(a[0].length),e=!0;continue}const u=i.match(/^(https?:\/\/[^\s<>\[\]]+)/);if(u)n.push({type:"link",url:u[1],children:[{type:"text",value:u[1]}]}),i=i.slice(u[0].length),e=!0;else if(!e){const e=i.search(/[`*_~!\[\n]|https?:\/\//);if(-1===e){n.push({type:"text",value:i});break}0===e?(n.push({type:"text",value:i[0]}),i=i.slice(1)):(n.push({type:"text",value:i.slice(0,e)}),i=i.slice(e))}}return function(e){const t=[];for(const n of e)"text"===n.type&&t.length>0&&"text"===t[t.length-1].type?t[t.length-1].value+=n.value:t.push(n);return t}(n)}function l(e,t){return s(e.replace(/\n/g," "))}e.version="1.1.1","undefined"!=typeof module&&module.exports&&(module.exports=e),"undefined"!=typeof window&&(window.quikdown_ast=e);const c="quikdown-",o={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},a={h1:"font-size:2em;font-weight:600;margin:.67em 0;text-align:left",h2:"font-size:1.5em;font-weight:600;margin:.83em 0",h3:"font-size:1.25em;font-weight:600;margin:1em 0",h4:"font-size:1em;font-weight:600;margin:1.33em 0",h5:"font-size:.875em;font-weight:600;margin:1.67em 0",h6:"font-size:.85em;font-weight:600;margin:2em 0",pre:"background:#f4f4f4;padding:10px;border-radius:4px;overflow-x:auto;margin:1em 0",code:"background:#f0f0f0;padding:2px 4px;border-radius:3px;font-family:monospace",blockquote:"border-left:4px solid #ddd;margin-left:0;padding-left:1em",table:"border-collapse:collapse;width:100%;margin:1em 0",th:"border:1px solid #ddd;padding:8px;background-color:#f2f2f2;font-weight:bold;text-align:left",td:"border:1px solid #ddd;padding:8px;text-align:left",hr:"border:none;border-top:1px solid #ddd;margin:1em 0",img:"max-width:100%;height:auto",a:"color:#06c;text-decoration:underline",strong:"font-weight:bold",em:"font-style:italic",del:"text-decoration:line-through",ul:"margin:.5em 0;padding-left:2em",ol:"margin:.5em 0;padding-left:2em",li:"margin:.25em 0","task-item":"list-style:none","task-checkbox":"margin-right:.5em"};function u(e){return e?String(e).replace(/[&<>"']/g,e=>o[e]):""}function d(e){if(!e)return"";const t=e.trim(),n=t.toLowerCase(),i=["javascript:","vbscript:","data:"];for(const e of i)if(n.startsWith(e))return"data:"===e&&n.startsWith("data:image/")?t:"#";return t}function h(t,n={}){if(!t)return{type:"document",children:[]};if("object"==typeof t&&t.type)return t;if("string"==typeof t){const i=t.trim();if(i.startsWith("{")||i.startsWith("["))try{const e=JSON.parse(i);return"document"===e.type?e:Array.isArray(e)?{type:"document",children:e}:e}catch(e){}if(i.includes("type:")&&(i.includes("children:")||i.includes("value:")))try{const e=f(i.split("\n"),0,0).value;if(e&&e.type)return e}catch(e){}return e(t,n)}return{type:"document",children:[]}}function f(e,t,n){if(t>=e.length)return{value:null,nextLine:t};const i=e[t],r=i.trim();if(""===r)return f(e,t+1,n);const s=i.search(/\S/);if(s<n&&s>=0)return{value:null,nextLine:t};if(r.startsWith("- "))return function(e,t,n){const i=[];let r=t;for(;r<e.length;){const t=e[r],s=t.trim();if(""===s){r++;continue}const l=t.search(/\S/);if(l<n&&l>=0)break;if(l>n&&i.length>0){r++;continue}if(!s.startsWith("- "))break;const c=s.slice(2);if(c.includes(":")){const t={},s=c.indexOf(":"),o=c.slice(0,s).trim();let a=c.slice(s+1).trim();if(""===a||a.startsWith("\n")){const n=f(e,r+1,l+2);t[o]=n.value,r=n.nextLine}else t[o]=p(a),r++;for(;r<e.length;){const i=e[r],s=i.trim();if(""===s){r++;continue}const l=i.search(/\S/);if(l<=n)break;if(s.startsWith("- "))break;const c=s.indexOf(":");if(c>0){const n=s.slice(0,c).trim();let i=s.slice(c+1).trim();if(""===i||i.startsWith("\n")){const i=f(e,r+1,l+2);t[n]=i.value,r=i.nextLine}else t[n]=p(i),r++}else r++}i.push(t)}else i.push(p(c)),r++}return{value:i,nextLine:r}}(e,t,s);if("[]"===r)return{value:[],nextLine:t+1};if("{}"===r)return{value:{},nextLine:t+1};return r.indexOf(":")>0?function(e,t,n){const i={};let r=t;for(;r<e.length;){const t=e[r],s=t.trim();if(""===s){r++;continue}const l=t.search(/\S/);if(l<n&&l>=0)break;const c=s.indexOf(":");if(c<=0){r++;continue}const o=s.slice(0,c).trim();let a=s.slice(c+1).trim();if(""===a||"|"===a||">"===a){const t=f(e,r+1,l+2);i[o]=t.value,r=t.nextLine}else i[o]=p(a),r++}return{value:i,nextLine:r}}(e,t,s):{value:p(r),nextLine:t+1}}function p(e){if(!e)return null;const t=e.trim();return"null"===t||"~"===t?null:"true"===t||"false"!==t&&(t.startsWith('"')&&t.endsWith('"')||t.startsWith("'")&&t.endsWith("'")?t.slice(1,-1).replace(/\\n/g,"\n").replace(/\\"/g,'"').replace(/\\\\/g,"\\"):/^-?\d+$/.test(t)?parseInt(t,10):/^-?\d+\.\d+$/.test(t)?parseFloat(t):t)}function m(e,t={}){return g(h(e,t),t)}function g(e,t={}){if(!e)return"";const{inline_styles:n=!1}=t,i=function(e){return function(t,n=""){if(e){let e=a[t];return e||n?(n&&n.includes("text-align")&&e&&e.includes("text-align")&&(e=e.replace(/text-align:[^;]+;?/,"").trim(),e&&!e.endsWith(";")&&(e+=";")),` style="${n?e?`${e}${n}`:n:e}"`):""}{const e=` class="${c}${t}"`;return n?`${e} style="${n}"`:e}}}(n);return $(e,i,t)}function $(e,t,n){if(!e)return"";switch(e.type){case"document":return y(e.children,t,n);case"paragraph":return`<p>${y(e.children,t,n)}</p>`;case"heading":const i=e.level||1;return`<h${i}${t("h"+i)}>${y(e.children,t,n)}</h${i}>`;case"code_block":const r=!n.inline_styles&&e.lang?` class="language-${e.lang}"`:"",s=n.inline_styles?t("code"):r;return`<pre${t("pre")}><code${s}>${u(e.content)}</code></pre>`;case"blockquote":return`<blockquote${t("blockquote")}>${y(e.children,t,n)}</blockquote>`;case"list":const l=e.ordered?"ol":"ul",o=(e.items||[]).map(e=>$(e,t,n)).join("");return`<${l}${t(l)}>${o}</${l}>`;case"list_item":if(null!==e.checked&&void 0!==e.checked){const i=n.inline_styles?' style="margin-right:.5em"':` class="${c}task-checkbox"`,r=e.checked?" checked":"";return`<li${n.inline_styles?' style="list-style:none"':` class="${c}task-item"`}><input type="checkbox"${i}${r} disabled> ${y(e.children,t,n)}</li>`}return`<li${t("li")}>${y(e.children,t,n)}</li>`;case"table":return function(e,t,n){const i=e.alignments||[];let r=`<table${t("table")}>\n`;e.headers&&e.headers.length>0&&(r+="<thead>\n<tr>\n",e.headers.forEach((e,s)=>{const l=i[s]&&"left"!==i[s]?`text-align:${i[s]}`:"";r+=`<th${t("th",l)}>${y(e,t,n)}</th>\n`}),r+="</tr>\n</thead>\n");e.rows&&e.rows.length>0&&(r+="<tbody>\n",e.rows.forEach(e=>{r+="<tr>\n",e.forEach((e,s)=>{const l=i[s]&&"left"!==i[s]?`text-align:${i[s]}`:"";r+=`<td${t("td",l)}>${y(e,t,n)}</td>\n`}),r+="</tr>\n"}),r+="</tbody>\n");return r+="</table>",r}(e,t,n);case"hr":return`<hr${t("hr")}>`;case"text":return u(e.value||"");case"strong":return`<strong${t("strong")}>${y(e.children,t,n)}</strong>`;case"em":return`<em${t("em")}>${y(e.children,t,n)}</em>`;case"del":return`<del${t("del")}>${y(e.children,t,n)}</del>`;case"code":return`<code${t("code")}>${u(e.value||"")}</code>`;case"link":const a=d(e.url),h=/^https?:\/\//i.test(a)?' rel="noopener noreferrer"':"";return`<a${t("a")} href="${a}"${h}>${y(e.children,t,n)}</a>`;case"image":const f=d(e.url);return`<img${t("img")} src="${f}" alt="${u(e.alt||"")}">`;case"br":return"<br>";default:return e.children?y(e.children,t,n):void 0!==e.value?u(String(e.value)):""}}function y(e,t,n){return e?Array.isArray(e)?e.map(e=>$(e,t,n)).join(""):$(e,t,n):""}return m.toAst=h,m.renderAst=g,m.version="1.1.1","undefined"!=typeof module&&module.exports&&(module.exports=m),"undefined"!=typeof window&&(window.quikdown_ast_html=m),m});
//# sourceMappingURL=quikdown_ast_html.umd.min.js.map
